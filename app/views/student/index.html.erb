<% if !session[:user_id] %>
  <p>Please login or register.
  <%= link_to 'Login', student_login_path %>
  </p>
  <%= redirect_to :action => "login" %>
<% else %>
<div class="container-fluid" style="padding-left:5%;margin-left:auto;margin-right:auto;width:97%">
<!--<h1> Welcome <%= @student.first_name %> </h1>-->
  <div class = "row-fluid">
    <!--Left side classes navpanel-->
    <div class="span3">
      <div class="well sidebar-nav" style="height:550px;">
        <ul class="nav nav-list">
	  <!--Classes-->
	  <li class="nav-header">
	    <a href="#" style="color:gray;">All Classes</a>
	  </li>
	    <% first = 0 %>
	    <% @channels.each do |c| %>
	      <% if first==0 %>
	      <li class="active">
	      <% first = 1%>
	      <% else %>
	      <li>
	      <% end %>
	        <a href="#class_<%= c.id %>" id="class<%= c.id %>" data-toggle="tab"><%= c.channelable.dept.name %> <%= c.channelable.class_no %></a>
	      </li>
	    <% end %>
	  <!--Clubs-->
	  <li class="nav-header">
	    <a href="#" style="color:gray;">Clubs</a>
	  </li>
	    <li>
	      <a href="#">IEEE</a>
	    </li>
	    <li>
	      <a href="#">ISA</a>
	    </li>
	</ul>
      </div>
    </div>

    <!--scripts to handle class changes-->
    <script>
      $(function() {
	<% @channels.each do |c| %>
	  $('#class<%= c.id %>').click(function(event){
            $('#infobox').html("<%= escape_javascript(render(:partial => "infoview", :locals => {:channel => @channels[c.id-1]})) %>");
          });
	<% end %>
	  $(".entry1").click(function(){
	    window.location=$(this).find("a").attr("href");
            return false;
	  });
      });
    </script>

    <div class="span8">
    <div class="well2" style="height:550px;width:98%;margin-left:-20px;">

    <!--Main content-->
    <div class="span7" style="margin-left:-5px;width:65%;">
      <!--info box-->
      <div class="well3 tab-content" id="infobox">
	  <!--default channel info-->
          <div>
	    <% @teacher =  @channels[0].leader %>
            <h2><%= @channels[0].channelable.dept.name %> <%= @channels[0].channelable.class_no %></h2>
	    <p style="font-size:12px;">
	      Professor <%= @teacher.first_name %> <%= @teacher.last_name %>
	      <br/>
              <%= @teacher.department %>
	    </p>
	    <p style="font-size:12px;">
	      <%= @channels[0].channelable.schedule %>
	      <br/>
              <%= @teacher.location %>
	    </p>
	</div>
      </div>
      <!--nutshell box-->
      <div class="well3">
        <h3> Nutshell</h3>
	<div class="scrollArea">
	  <div class="entry1">
	    <h4>Today</h4>
	    <p><span style="color:red;font-weight:bold;">In Class: </span><span>Rhetoric Speech</span></p>
	    <p style="margin-top:-10px;"><span style="color:red;font-weight:bold;">HW 5: </span><span>Vocab due</span><span>
	    <a href="blah" style="float:right">View Post</a>
	    </span></p>
	  </div>
	  <p class="drawline"></p>
	</div>
      </div>
    </div>

    <!--Right side calendar etc content-->
    <div class="span4">
      <!--calendar box-->
      <div class="well3">
	<% time = Time.new %>
	<% start_date = Date.parse("#{time.year}-#{time.month}-01")-1 %>
	<% num_days =  (Date.new(time.year,12,31).to_date<<(12-time.month)).day %>
	<h4><center><%= time.strftime("%B")%> <%= time.strftime("%Y")%></center></h4>
	<table class="table" style="font-size:10px;margin-bottom:-9px;">
          <thead>
	    <tr style="padding-bottom:0px;">
	      <th style="padding-top:4px;padding-bottom:0px;">Mo</th>
	      <th style="padding-top:4px;padding-bottom:0px;">Tu</th>
	      <th style="padding-top:4px;padding-bottom:0px;">We</th>
	      <th style="padding-top:4px;padding-bottom:0px;">Th</th>
	      <th style="padding-top:4px;padding-bottom:0px;">Fr</th>
	      <th style="padding-top:4px;padding-bottom:0px;">Sa</th>
	      <th style="padding-top:4px;padding-bottom:0px;">Su</th>
	    </tr>
	  </thead>
	  <tbody>
	        <tr style="padding-top:0px;padding-bottom:0px;">
	    <% d = 1 %>
	    <% for i in 0...35 %>
	      <% if (i%7)==0 %>
	        </tr><tr style="padding-top:0px;padding-bottom:0px;">
	      <% end %>
	      <% if i < start_date.wday %>
	        <td style="padding-top:0px;padding-bottom:0px;"></td>
	      <% elsif d > num_days %>
	        <td style="padding:0px;"></td>
              <% else %>
	        <td style="padding-top:0px;padding-bottom:0px;"><%= d %></td>
		<% d+=1 %>
	      <% end %>
	    <% end %>  
	    </tr>
	  </tbody>
	</table>
      </div>
      <!--syllabus box-->
      <div class="well3">
        <div class="scrollArea_syll" style="overflow-x:hidden;">
	  <ul class="nav nav-listnav nav-list">
	    <li><a href="#">Syllabus</a></li>
	    <li><a href="#">Course Schedule</a></li>
	    <li><a href="#">Course Material</a></li>
	  </ul>
	</div>
      </div>
    </div>

    <!--General | Updates | Questions-->
    <div class="span11">
      <div class="well4">
      <ul class="nav nav-tabs">
        <li class="active"><a href="#updates" data-toggle="tab">Updates</a></li>
	<li><a href="#general" data-toggle="tab">General</a></li>
	<li><a href="#questions" data-toggle="tab">Questions</a></li>
      </ul>

      <div class="tab-content">
        <div class="tab-pane active" id="updates">
	  <ul>
	    <li>HW2 due date changed from the 23rd to the 25th.</li>
	    <li>No class on tuesday the 23rd.</li>
	  </ul>
	</div>
	<div class="tab-pane" id="general">
	  General Stuff
	</div>
	<div class="tab-pane" id="questions">
	  Questions
	</div>
      </div>
      <script>
        $(function(){ 
		$('#general').tab('show')
	})
      </script>
      </div>
    </div>
  </div>
</div>
<% end %>
